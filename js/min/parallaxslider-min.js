function parallaxSlider(i){function t(i){var t=$(window).outerWidth(),e=$(window).outerHeight(),o=i.eq(0).width(),n=i.eq(0).height(),r,a;"h"==s.orientation?(r=s.dimensions[1]>e?e/2:"50%",i.css({top:r,marginTop:-n/2})):"v"==s.orientation&&(a=s.dimensions[0]>t?t/2:"50%",i.css({left:a,marginLeft:-o/2}))}var $=jQuery;this.setting={displaymode:{type:"auto",pause:2e3,stoponclick:!1,cycles:2,pauseonmouseover:!0},delaybtwdesc:500,activeslideclass:"selectedslide",orientation:"h",persist:!0,slideduration:500},jQuery.extend(this.setting,i),this.setting.displaymode.pause+=400+this.setting.slideduration,this.curslide=this.setting.persist?parallaxSlider.routines.getCookie("slider-"+this.setting.wrapperid):0,this.curstep=0,this.curzindex=0,this.animation_isrunning=!1,this.posprop="h"==this.setting.orientation?"left":"top",i=null;var e=this,s=this.setting,o=[],n=0,r=0;$(function(){e.$wrapperdiv=$("#"+s.wrapperid);for(var i=e.$wrapperdiv.find("div.bgoverlay").filter(function(i){var t=$(this);return t.data("bgimage")||"none"!=t.css("backgroundImage")}),t=i.length,n=0;n<i.length;n++){var a=i.eq(n);a.data("bgimage")&&a.css("backgroundImage","url("+a.data("bgimage")+")");var d=a.css("backgroundImage");o[n]=new Image,$(o[n]).bind("load error",function(){r++,r==t&&e.init($)}),o[n].src=d}}),this.positioncontrols=t,$(window).bind("unload",function(){e.setting.persist&&parallaxSlider.routines.setCookie("slider-"+s.wrapperid,e.curslide)}),$(window).bind("resize",function(){s.dimensions&&(s.dimensions=[e.$wrapperdiv.width(),e.$wrapperdiv.height()],t(e.$controls))})}parallaxSlider.prototype={slide:function(i,t){var e=/(left|top)/.test(t)?"back":"forth";if(this.curslide!=i){var s=this,o=this.setting,n=parallaxSlider.routines.createobj,r=o.dimensions["right"==t||"left"==t?0:1]*("right"==t||"down"==t?-1:1),a=-r,d=this.posprop;null!=this.animation_isrunning&&(this.animation_isrunning=!0);var l=this.$imageslides.eq(i).show().css(n([d,r],["zIndex",1])),c=l.data("$descs"),h=this.$imageslides.eq(this.curslide),u=h.data("$descs");l.stop().velocity(n([d,0]),o.slideduration,[.75,.03,0,.97],function(){var i=jQuery(this);i.addClass(o.activeslideclass),s.animation_isrunning=!1}),c.each(function(i){var t=jQuery(this);t.stop().css(n([d,r])).velocity(n([d,0]),[.75,.03,0,.97],t.data("duration"))}),h.css({zIndex:0}).removeClass(o.activeslideclass).stop().velocity(n([d,"left"==t||"up"==t?-100:100]),500,"ease",function(){var i=jQuery(this);i.hide()}),u.each(function(i){var e=jQuery(this);e.stop().velocity(n([d,"left"==t||"up"==t?"-100%":"100%"]),[.52,.25,.94,.51],.5*e.data("duration"))}),this.curslide=i}},navigate:function(i){var t=this,e=this.setting;clearTimeout(this.rotatetimer),e.displaymode.stoponclick||"manual"==e.displaymode.type||(this.curstep="back"==i?this.curstep-1:this.curstep+1,this.rotatetimer=setTimeout(function(){t.rotate()},e.displaymode.pause));var s="back"==i?"h"==e.orientation?"right":"down":"h"==e.orientation?"left":"up",o="back"==i?this.curslide-1:this.curslide+1;o=0>o?this.$imageslides.length-1:o>this.$imageslides.length-1?0:o,0==this.animation_isrunning&&this.slide(o,s)},rotate:function(){var i=this,t=this.setting;if(this.ismouseover)return void(this.rotatetimer=setTimeout(function(){i.rotate()},t.displaymode.pause));var e=this.curslide<this.$imageslides.length-1?this.curslide+1:0;this.slide(e,this.posprop),(0==t.displaymode.cycles||this.curstep<this.maxsteps-1)&&(this.rotatetimer=setTimeout(function(){i.rotate()},t.displaymode.pause),this.curstep++)},init:function($){var i=this,t=this.setting;if(t.dimensions=[this.$wrapperdiv.width(),this.$wrapperdiv.height()],this.$wrapperdiv.css({position:"relative",visibility:"visible",overflow:"hidden",backgroundImage:"none"}),0==this.$wrapperdiv.length)return void alert('Error: DIV with ID "'+t.wrapperid+'" not found on page.');this.$imageslides=this.$wrapperdiv.find("div.slide").hide(),this.curslide=null==this.curslide||this.curslide>this.$imageslides.length-1?0:parseInt(this.curslide),this.$imageslides.each(function(i){var e=$(this).find("div.desc").css({position:"absolute",left:0,top:0,width:"100%",height:"100%"});$(this).data({$descs:e});var s=t.slideduration;e.each(function(i){$(this).data({duration:s+=t.delaybtwdesc})})}),this.$imageslides.eq(this.curslide).show().css(parallaxSlider.routines.createobj([this.posprop,0])).addClass(t.activeslideclass).stop().find("div.desc").css({left:0});var e=t.orientation,s="h"==e?t.navbuttons.slice(0,2):t.navbuttons.slice(2),o=$('<img class="navbutton" src="'+s[1]+'" data-dir="forth" style="position:absolute; z-index:5; cursor:pointer; '+("v"==e?"bottom:8px; left:46%":"top:46%; right:8px;")+'" /><img class="navbutton" src="'+s[0]+'" data-dir="back" style="position:absolute;z-index:5; cursor:pointer; '+("v"==e?"top:8px; left:45%":"top:45%; left:8px;")+'" />').css({opacity:0}).click(function(){var e=this.getAttribute("data-dir");t.curslide="right"==e?t.curslide==t.content.length-1?0:t.curslide+1:0==t.curslide?t.content.length-1:t.curslide-1,i.navigate(e)});this.$controls=o.appendTo(this.$wrapperdiv),this.positioncontrols(this.$controls),"auto"==t.displaymode.type&&(t.displaymode.pause+=t.slideduration,this.maxsteps=t.displaymode.cycles*this.$imageslides.length,t.displaymode.pauseonmouseover&&(this.$wrapperdiv.mouseenter(function(){i.ismouseover=!0}),this.$wrapperdiv.mouseleave(function(){i.ismouseover=!1})),this.rotatetimer=setTimeout(function(){i.rotate()},t.displaymode.pause));var n={triggerOnTouchEnd:!0,triggerOnTouchLeave:!0,fallbackToMouseEvents:!0,allowPageScroll:"h"==t.orientation?"vertical":"horizontal",swipethreshold:t.swipethreshold,excludedElements:[]};n.swipeStatus=function(e,s,o,n){if("start"==s&&"A"==e.target.tagName&&(evtparent.onclick=function(){return!1}),"cancel"==s&&"A"==e.target.tagName&&(evtparent.onclick=function(){return!0}),"end"==s){var r=/(right)|(down)/i.test(o)?"back":"forth";("h"==t.orientation&&/(left)|(right)/i.test(o)||"v"==t.orientation&&/(up)|(down)/i.test(o))&&i.navigate(r)}},this.$wrapperdiv.swipe&&this.$wrapperdiv.swipe(n),this.$wrapperdiv.bind("mouseenter click",function(){i.$controls&&2==i.$controls.length&&i.$controls.stop().velocity({opacity:1})}),this.$wrapperdiv.bind("mouseleave",function(){i.$controls&&2==i.$controls.length&&i.$controls.stop().velocity({opacity:0},"fast")})}},parallaxSlider.routines={getSlideHTML:function(i,t,e,s,o){var n=o+":"+("left"==o?e:s);return'<div class="slide" style="background-image:url('+t[0]+"); position:absolute;"+n+";width:"+e+"; height:"+s+'; z-index: 0">'+(t[1]?'<div class="desc">'+t[1]+"</div>\n":"")+"</div>"},getCookie:function(i){var t=new RegExp(i+"=[^;]+","i");return document.cookie.match(t)?document.cookie.match(t)[0].split("=")[1]:null},setCookie:function(i,t){document.cookie=i+"="+t+";path=/"},createobj:function(){for(var i={},t=0;t<arguments.length;t++)i[arguments[t][0]]=arguments[t][1];return i}};